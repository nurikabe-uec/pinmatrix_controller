# Pinmatrix (Face) Controller

- ピンマトリクスを制御するためのコード

## 構成

2019/9/7 現在

- マイコン: Arduino Uno
- 参考論文: [shapeShift](https://www.youtube.com/watch?v=Z6LSsJoDdtY)

### モータの制御

- モータ ([TTMotor TGPP06-C](http://www.ttmotor.com/productshow.php?sid=212&id=122) (論文より)) にシリコンチューブを介して，シャフト(全ネジ M4)をつけ アルミ角パイプ(10mm角)を上下させる
  - 全ネジM4 のピッチは 0.7mm で，モータ (TGPP06-C) の回転数は 1250 rpm (rotation per minute) (データシートより) つまり 20.833 rps (だいたい1秒で 20回転)
    - つまり， 0.7mm x 20.833 rps より 1秒で 約 1.5cm 上下移動する．(結構遅い)
  - もし，ピッチを 2mm 程度にできたら
    - 2mm x 20.833rps より 1秒で 約 4cm  上下する
  - ピッチ幅がリニアに影響するので，ネジ(シャフト)のピッチが広いほど早く上下する．
- シリコンチューブをはさむ理由は, 軸が少しぶれても回せるようにするため．
  - (だいたい，論文のとおり)

#### 入力

- DACを使い SPI通信を通して多チャンネル対応．IC (LTC1665)一つあたり, モータ4個まで
  - つまり，この設計では一列当たり，ICを 4つ使い，全部で 80個使うことになる．

#### 制御

- エンコーダとしてフォトインタラプタを採用 (参考論文で，使っていた)
- 今のところ 1層のエンコーダで回転方向はソフトウェア側で制御する．しかしながら，1つではエラーに弱いという欠点もある．
- シリコンチューブに切り込みをいれ，フォトインタラプタの値の変化を閾値によってカウント
  - 1回転 1カウント．
- 2019/9/7 現在． 1本ではこの方法はうまくいったが，複数のピンを同時に制御しようとした時，フォトインタラプタからの信号値が安定せず，まだ制御に成功していない．

## 問題点 (2019/9/7 現在)

- ピンが安定して回らない時がある．
- フォトインタラプタで，複数のピンを同時に制御できるか制御できていない．

### 方針

- 外装やピンの径などを見直し，ピンを安定的に動かすことを目指す．
